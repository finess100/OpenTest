#!/bin/bash
#echo "Objet $1 au rapport"

start=$(date +%s.%N)

objet_valeurs=$1

objet_id=$(echo $objet_valeurs | cut -d";" -f1 | cut -d":" -f2 )
objet_nom=$(echo $objet_valeurs | cut -d";" -f2 | cut -d":" -f2 )
objet_prix=$(echo $objet_valeurs | cut -d";" -f3 | cut -d":" -f2 )
objet_poids=$(echo $objet_valeurs | cut -d";" -f4 | cut -d":" -f2 )
objet_couleur=$(echo $objet_valeurs | cut -d";" -f5 | cut -d":" -f2 )

#echo "objet_id=$objet_id"
#echo "objet_nom=$objet_nom"
#echo "objet_prix=$objet_prix"
#echo "objet_poids=$objet_poids"
#echo "objet_couleur=$objet_couleur"

#~~ Calcul des r√®gles

# Le prix
sh ./rules/prix.sh $objet_id $objet_nom $objet_prix 

# Le poids
sh ./rules/poids.sh $objet_id $objet_nom $objet_poids 

# La couleur
sh ./rules/couleur.sh $objet_id $objet_nom $objet_couleur 


# Les deux

#~~ Essai : boucle de lancement des enfants

fichier_objet=$(cat config/objets)

for objet in $fichier_objet;do

	echo "objet_id = $objet_id"

	objet_enfant_id=$(echo $objet | cut -d";" -f1 | cut -d":" -f2 )
	sh template/dimension "$objet_id $objet_enfant_id" &

done

runtime=$(echo "$(date +%s.%N) - $start" | bc)
echo "Runtime template classique $objet_id: $runtime"
